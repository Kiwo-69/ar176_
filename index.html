<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>3D Модель</title>
  <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
</head>
<body>

  <button onclick="showModel()">Показать модель</button>
  <div id="model-container" style="display: none;">
    <model-viewer
      id="viewer"
      src=""
      ios-src=""
      alt="3D модель"
      auto-rotate
      camera-controls
      ar
      ar-modes="scene-viewer webxr quick-look"
      interaction-prompt="none"
      style="width: 100%; height: 400px;">
    </model-viewer>
    <button id="ar-button">AR</button>
  </div>

  <a id="ios-ar-link" rel="ar"></a>

  <script>
    let currentGLB = "https://storage.yandexcloud.net/176/folding_table.glb";
    let currentUSDZ = "https://storage.yandexcloud.net/176/Folding_table.usdz";

    function showModel() {
      const container = document.getElementById("model-container");
      const viewer = document.getElementById("viewer");
      viewer.src = currentGLB;
      viewer.setAttribute("ios-src", currentUSDZ);
      container.style.display = "block";
    }

    document.getElementById("ar-button").addEventListener("click", () => {
      const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent);
      if (isIOS) {
        const iosLink = document.getElementById("ios-ar-link");
        iosLink.href = currentUSDZ + "#allowsContentScaling=0";
        iosLink.click();
      } else {
        document.getElementById("viewer").activateAR();
      }
    });
  </script>
</body>
</html>
